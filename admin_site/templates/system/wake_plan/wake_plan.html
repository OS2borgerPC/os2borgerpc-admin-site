{% extends "system/wake_plan/wake_plan_base.html" %}
{% load crispy_forms_tags %}

{% block specific_content %}

<div class="container-flud main sublevelmain">

  <h1 class="divideheader">{{selected_plan.name|default:"Ny Tænd/Sluk tidsplan"}}</h1>

  <form method="post" class="gray-box">

    {% csrf_token %}

    <div class="container-fluid">

      <div class="row">

        <article class="col-lg-6">

          {{form.name|as_crispy_field}}

          {{form.sleep_state|as_crispy_field}}

          <p class="mt-4"><strong>Ugeplan</strong></p>
          <p>Konfigurer tænd og sluk for den faste ugeplan</p>
          <table class="form-switch table">
            <tr>
              <td>
                <strong>Mandag</strong>
              </td>
              <td>
                <input class="form-check-input fs-5" type="checkbox" role="switch" id="flexSwitchCheckChecked" {% if form.monday_on and form.monday_off %}checked{% endif %}>
                <label class="form-check-label" for="flexSwitchCheckDefault">{% if not form.monday_on and not form.monday_off %}Slukket{% else %}Tændt{% endif %}</label>
              </td>
              <td>
                {{form.monday_on}}
              </td>
              <td>-</td>
              <td>
                {{form.monday_off}}
              </td>
            </tr>
          </table>

        </article>

        <aside class="col-lg-6">
          <p class="mt-4"><strong>Lukkedage og undtagelser</strong></p>
          <p>Planlæg kommende lukkedage eller opret undtagelser fra den faste ugeplan</p>

          {# Wake events #}
          <ul class="list-group">
            {% for event in selected_plan.wake_events.all %}
              <li class="list-group-item d-flex">
                <p class="flex-grow-1">{{event}}</p>
                <span class="material-icons delete">delete_outline</span>
              </li>
            {% endfor %}
          </ul>

          <button class="btn"><span class="material-icons">date_range</span></span>Tilføj periode</button>
          <button class="btn"><span class="material-icons">today</span>Tilføj dato</button>

          <p class="mt-4"><strong>Grupper der følger tidsplanen</strong></p>

          {# PCGroup picklist #}
          <fieldset class="col-12 col-lg-12">

            {{ form.groups.errors }}
            <div class="clearfix">
              <span class="badge bg-secondary picklist-counter-badge" style="float: right;">
                <span class="material-icons px-1">queue</span>
                <span id="total-groups"></span>
              </span>
            </div>
            {% include 'widgets/picklist.html' with submit_name='groups' selected_list=selected_groups available_list=available_groups identifier='gruppe' add_text='Tilføj gruppe til tidsplan' remove_text='Fjern computer fra tidsplan' site_url=site.uid target_section='groups' %}

          </fieldset>

        </aside>
      </div>
    </div>
        <input class="btn btn-primary me-3" type="submit" name="submit" value="Gem ændringer">
        <input class="btn btn-secondary me-3" type="reset" name="cancel" value="Nulstil">
        {# Only show the button to duplicate a plan if you're updating an existing entry - not creating a new one#}
        {% if selected_plan.id %}
          <a class="btn btn-secondary" href="{% url 'wake_plan_copy' site.uid selected_plan.id %}">Kopier tidsplan</a>
        {% endif %}

  </form>

</div>

{% endblock %}
